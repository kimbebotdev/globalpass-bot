# Globalpass Bot Usage Guide

This guide explains how to use the Globalpass Bot web app, what happens during a run, and what you can expect from Slack notifications.

## Quick Start

1. Open the web UI.
2. Choose **Form** (recommended for most users).
3. Fill in your flight details.
4. Click **Run All Bots** and wait for results.

## Form Fields (Most Common Path)

**Flight Type**
- One‑way: one trip and one itinerary leg.
- Round‑trip: two trips and two itinerary legs.
- Multiple legs: one or more trips and itinerary legs.

**Travel Status**
- Choose between *R2 Standby* and *Bookable*. This affects how results are ranked.

**Airline**
- Optional filter. Leave blank to search all airlines.

**Non‑stop Only**
- Limits to non‑stop flights where possible.

**Trips & Itinerary**
- **Origin** and **Destination** are required for each trip.
- **Date**, **Time**, and **Class** are required for each itinerary leg.

**Travel Partners (Optional)**
- Add adult or child partners traveling with you.
- Adults require salutation, first name, last name.
- Children require first name, last name, and date of birth.
- Own seat defaults to true.

## JSON Input (Advanced)

If you prefer to provide a full JSON payload:

1. Switch **Input Mode** to **JSON Input**.
2. Paste or import a valid JSON payload.
3. Click **Run All Bots**.

The JSON should include:

```json
{
  "flight_type": "one-way",
  "travel_status": "Bookable",
  "nonstop_flights": true,
  "airline": "",
  "trips": [{ "origin": "DXB", "destination": "SIN" }],
  "itinerary": [{ "date": "02/01/2026", "time": "00:00", "class": "Economy" }],
  "traveller": [{ "name": "Rafael Cruz", "salutation": "MR", "checked": true }],
  "travel_partner": []
}
```

If a JSON payload is invalid or missing required fields, the run is blocked and you’ll see errors in the UI and Slack.

## What Happens When You Run

1. The app validates your input.
2. The bots start:
   - **MyIDTravel** for staff availability and load signals.
   - **Google Flights** for commercial listings and prices.
   - **StaffTraveler** for crowd‑sourced load info.
3. Results are merged into a single report.
4. The final report is downloadable from the UI (JSON or Excel).

The **Top 5** section is generated by Gemini using all three JSON sources.

## Slack Notifications

When Slack is configured:

- A **Run started** message is posted to your channel.
- Status updates appear in the same thread.
- If input is invalid, a thread reply explains what needs fixing.
- If flight loads are missing from a source, a note is posted in the thread.
- When complete, you’ll get a summary + a download link for the Excel report.

## Downloads

From the results section in the UI:

- Export JSON
- Export Excel

You can also download directly:

- `GET /api/runs/{run_id}/download/json`
- `GET /api/runs/{run_id}/download-report-xlsx`
